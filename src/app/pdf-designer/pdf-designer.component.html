<body>
    <div class="container">
      <div class="view-account">
        <section class="module">
          <div class="module-inner">
            <div class="content-panel">
              <h2 class="title">Design CV PDF</h2>
              <form class="form-horizontal" #cvForm="ngForm">
                
                <fieldset class="fieldset">
                  <h3 class="fieldset-title">General Info</h3>

                  <div class="form-group">
                    <label for="firstName" class="col-md-2 col-sm-3 col-xs-12 control-label">First Name</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="cv.person.firstName"
                        placeholder="First Name" id="firstName" name="firstName" #firstName="ngModel" required
                        autocomplete="off">
                      <div *ngIf="firstName.errors && (firstName.dirty || firstName.touched)" class="alert alert-danger">
                        <div [hidden]="!firstName.errors.required">First Name is required!</div>
                        <div [hidden]="!firstName.errors.pattern">
                          First Name can only contain letters and numbers (3-30 characters)!
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="lastName" class="col-md-2 col-sm-3 col-xs-12 control-label">Last Name</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="cv.person.lastName"
                        placeholder="Last Name" id="lastName" name="lastName" #lastName="ngModel" required
                        autocomplete="off">
                      <div *ngIf="lastName.errors && (lastName.dirty || lastName.touched)" class="alert alert-danger">
                        <div [hidden]="!lastName.errors.required">Last Name is required!</div>
                        <div [hidden]="!lastName.errors.pattern">
                          Last Name can only contain letters and numbers (3-30 characters)!
                        </div>
                      </div>
                    </div>
                  </div> 

                  <div class="form-group">
                    <label for="position" class="col-md-2 col-sm-3 col-xs-12 control-label">Position</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="cv.position"
                        placeholder="Position" id="position" name="position" #position="ngModel" required
                        autocomplete="off">
                      <div *ngIf="position.errors && (position.dirty || position.touched)" class="alert alert-danger">
                        <div [hidden]="!position.errors.required">Last Name is required!</div>
                        <div [hidden]="!position.errors.pattern">
                          Last Name can only contain letters and numbers (3-30 characters)!
                        </div>
                      </div>
                    </div>
                  </div>                        
  
                </fieldset>  <br>
                  
                <fieldset class="fieldset">
                  <h3 class="fieldset-title">Contact Info</h3>

                  <div class="form-group">
                    <label for="phoneNumber" class="col-md-2 col-sm-3 col-xs-12 control-label">Phone Number</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" maxlength="20" pattern="^[+]*[0-9][0-9][(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*$" [(ngModel)]="cv.person.contact.phoneNumber"
                        placeholder="Phone Number" id="phoneNumber" name="phoneNumber" #phoneNumber="ngModel" required
                        autocomplete="off">
                      <div *ngIf="phoneNumber.errors && (phoneNumber.dirty || phoneNumber.touched)" class="alert alert-danger">
                        <div [hidden]="!phoneNumber.errors.required">Phone Number is required!</div>
                        <div [hidden]="!phoneNumber.errors.pattern">
                          Phone Number is incorrect!
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="email" class="col-md-2 col-sm-3 col-xs-12 control-label">Email</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" maxlength="50" pattern="^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$" [(ngModel)]="cv.person.contact.email"
                        placeholder="Email" id="email" name="email" #email="ngModel" required
                        autocomplete="off">
                      <div *ngIf="email.errors && (email.dirty || email.touched)" class="alert alert-danger">
                        <div [hidden]="!email.errors.required">Email is required!</div>
                        <div [hidden]="!email.errors.pattern">
                          Email address is incorrect!
                        </div>
                      </div>
                    </div>
                  </div>  
               
                </fieldset>  <br>

                <fieldset class="fieldset">
                  <h3 class="fieldset-title">Education</h3>

                  <div class="form-group">
                    <label for="degree" class="col-md-2 col-sm-3 col-xs-12 control-label">Degree</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="cv.education.degree"
                        placeholder="First Name" id="degree" name="degree" #degree="ngModel" required
                        autocomplete="off">
                      <div *ngIf="degree.errors && (degree.dirty || degree.touched)" class="alert alert-danger">
                        <div [hidden]="!degree.errors.required">First Name is required!</div>
                        <div [hidden]="!degree.errors.pattern">
                          First Name can only contain letters and numbers (3-30 characters)!
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="school" class="col-md-2 col-sm-3 col-xs-12 control-label">School</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="cv.education.school"
                        placeholder="School" id="school" name="school" #school="ngModel" required
                        autocomplete="off">
                      <div *ngIf="school.errors && (school.dirty || school.touched)" class="alert alert-danger">
                        <div [hidden]="!school.errors.required">Last Name is required!</div>
                        <div [hidden]="!school.errors.pattern">
                          Last Name can only contain letters and numbers (3-30 characters)!
                        </div>
                      </div>
                    </div>
                  </div> 

                  <div class="form-group">
                    <label for="specialty" class="col-md-2 col-sm-3 col-xs-12 control-label">Specialty</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="cv.education.specialty"
                        placeholder="Specialty" id="specialty" name="specialty" #specialty="ngModel" required
                        autocomplete="off">
                      <div *ngIf="specialty.errors && (specialty.dirty || specialty.touched)" class="alert alert-danger">
                        <div [hidden]="!specialty.errors.required">Last Name is required!</div>
                        <div [hidden]="!specialty.errors.pattern">
                          Last Name can only contain letters and numbers (3-30 characters)!
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="graduation" class="col-md-2 col-sm-3 col-xs-12 control-label">Graduation</label>
                    <div class="col-md-10 col-sm-9 col-xs-12">
                      <input type="text" class="form-control" pattern="^((19|20)[0-9]{2})$" [(ngModel)]="cv.education.graduation"
                        placeholder="graduation" id="graduation" name="graduation" #graduation="ngModel" required
                        autocomplete="off">
                      <div *ngIf="graduation.errors && (graduation.dirty || graduation.touched)" class="alert alert-danger">
                        <div [hidden]="!graduation.errors.required">Last Name is required!</div>
                        <div [hidden]="!graduation.errors.pattern">
                          Last Name can only contain letters and numbers (3-30 characters)!
                        </div>
                      </div>
                    </div>
                  </div>                        
  
                </fieldset>  <br>
  
                <fieldset class="fieldset">
                      <h3 class="fieldset-title">Job</h3>                 
                        <div *ngFor = "let job of cv.jobs; let in = index">   
                          
                          <div class="form-group">
                            <label for="printPdf" class="col-md-2 col-sm-3 col-xs-12 control-label">PrintPDF</label>
                            <input type="checkbox" [checked]="job.printPdf" (change)="job.printPdf = !job.printPdf"/>                                                     
                          </div> 

                          <div class="form-group">
                              <label for="position{{in}}" class="col-md-2 col-sm-3 col-xs-12 control-label">Position</label>
                              <div class="col-md-10 col-sm-9 col-xs-12">
                                <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="job.position"
                                  placeholder="Position" id="position{{in}}" name="position{{in}}" #position{{in}} = "ngModel" required
                                  autocomplete="off">                                                                 
                              </div>
                          </div>

                          <div class="form-group">
                            <label for="begin{{in}}" class="col-md-2 col-sm-3 col-xs-12 control-label">From</label>
                            <div class="col-md-10 col-sm-9 col-xs-12">
                              <input type="date" class="form-control" [(ngModel)]="job.begin"
                                placeholder="Last Name" id="begin{{in}}" name="begin{{in}}" #begin{{in}}="ngModel" required
                                autocomplete="off">                              
                            </div>                          
                          </div> 
      
                          <div class="form-group">
                            <label for="end{{in}}" class="col-md-2 col-sm-3 col-xs-12 control-label">To</label>
                            <div class="col-md-10 col-sm-9 col-xs-10">
                              <input type="date" class="form-control" [(ngModel)]="job.end"
                              placeholder="Last Name" id="end{{in}}" name="end{{in}}" #end{{in}}="ngModel" required
                              autocomplete="off">                           
                            </div>
                          </div>
                      
                          <div class="form-group">
                            <label for="company{{in}}" class="col-md-2 col-sm-3 col-xs-12 control-label">Company</label>
                            <div class="col-md-10 col-sm-9 col-xs-12">
                              <input type="text" class="form-control" pattern="^[\s\S]{0,200}$" [(ngModel)]="job.companyName"
                                placeholder="company" id="company{{in}}" name="company{{in}}" #company{{in}}="ngModel" required
                                autocomplete="off">                              
                            </div>
                          </div>       
                          
                          <div class="form-group">
                            <label for="description{{in}}" class="col-md-2 col-sm-3 col-xs-12 control-label">Description</label>
                            <div class="col-md-10 col-sm-9 col-xs-12">
                              <input type="text" class="form-control" pattern="^[\s\S]{0,200}$" [(ngModel)]="job.description"
                                placeholder="description" id="description{{in}}" name="description{{in}}" #description{{in}}="ngModel" required
                                autocomplete="off">
                              
                            </div>
                          </div>
                          
                          <h3 class="fieldset-title"></h3>
                  
                        </div>              
                
                </fieldset>  <br>

                <fieldset class="fieldset">

                  <h3 class="fieldset-title">Skills</h3>                 
                    <div *ngFor = "let skill of cv.skills; let in = index">   
                      
                      <fieldset class="experience-border">
                        <legend  class="experience-border">                       
                        PrintPDF                        
                        <input type="checkbox" [checked]="skill.printPdf" (change)="skill.printPdf = !skill.printPdf"/>                                                     
                      
                    </legend>

                      <div class="form-group">
                          <label for="title{{in}}" class="col-md-2 col-sm-3 col-xs-12 control-label">Position</label>
                          <div class="col-md-10 col-sm-9 col-xs-12">
                            <input type="text" class="form-control" pattern="^[A-Za-z]{3,30}$" [(ngModel)]="skill.title"
                                placeholder="Position" id="title{{in}}" name="title{{in}}" #title{{in}} = "ngModel" required
                                autocomplete="off">                                                                 
                          </div>
                      </div>                     
                        
                      <div class="form-group">
                        <label for="descriptionSkill{{in}}" class="col-md-2 col-sm-3 col-xs-12 control-label">Description</label>
                        <div class="col-md-10 col-sm-9 col-xs-12">
                          <input type="text" class="form-control" pattern="^[\s\S]{0,200}$" [(ngModel)]="skill.description"
                              placeholder="Description" id="descriptionSkill{{in}}" name="descriptionSkill{{in}}" #descriptionSkill{{in}}="ngModel" required
                              autocomplete="off">                            
                        </div>
                      </div>
                        
                      </fieldset>
                    </div>
              
                   <script>
                    $http({url: '/createPdf',method: 'GET',responseType: 'arraybuffer'})
                    .then(({ data }) => {
                        var file = new Blob([data], { type: 'application/pdf' });
                        var fileURL = URL.createObjectURL(file);
                        $window.open(fileURL);
                    })
                    </script>
              
              </fieldset>  <br>
  
                <fieldset class="fieldset">
                  <h3 class="fieldset-title">Action</h3>
  
                  <!----
                  <div class="form-group">
                    
                    <div *ngIf="cv.cvId != null">
                      <button [disabled]="!cvForm.form.valid" class="btn btn-success" (click)="update()">Update</button>
                    </div>
                    
                  </div>
                  ---->

                  <div class="form-group">
                  
                    <div *ngIf="cv.cvId != null">
                      <button [disabled]="!cvForm.form.valid" class="btn btn-success" (click)="showPdf()">Create CV PDF</button>
                    </div>
                  </div>
                </fieldset>
                  
              </form>
              
              
            </div>
          </div>  
        </section>
      </div>
    </div>
  </body>